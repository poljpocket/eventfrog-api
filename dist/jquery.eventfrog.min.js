(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){(function(global){(function(){const EventfrogService=require("./service/EventfrogService");const $=typeof window!=="undefined"?window["jQuery"]:typeof global!=="undefined"?global["jQuery"]:null;module.exports=async function(customOptions){let options=$.extend({apiKey:"",amount:0,perPage:0,page:1,search:"",group:"",organization:""},customOptions);let queryArgs={};if(options.search.length>0)queryArgs=$.extend({q:options.search},queryArgs);if(options.perPage>0&&options.amount===0)queryArgs=$.extend({perPage:options.perPage},queryArgs);if(options.page>0)queryArgs=$.extend({page:options.page},queryArgs);if(options.organization.length)queryArgs=$.extend({orgId:options.organization},queryArgs);const eventFrogLoader=new EventfrogService(options.apiKey);let events=await eventFrogLoader.loadEvents(queryArgs);if(options.perPage===0&&options.amount>0){events=events.filter(event=>options.group.length?event.group.id===options.group:true);events=events.slice(0,options.amount)}return events}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./service/EventfrogService":7}],2:[function(require,module,exports){const EventfrogUtil=require("../util/EventfrogUtil");class EventfrogEvent{constructor(data){this.id=data.id;this.externalSourceId=data.extSrcId;this.externalId=data.extId;this.groupId=data.groupId;this.topicId=data.rubricId;this._title=data.title;this.link=data.url;this.organizer={id:data.organizerId,name:data.organizerName,website:data.websiteUrl,facebook:data.facebookUrl,twitter:data.twitterUrl};this.presale={link:data.presaleLink,text:data.presaleText};this.image=data.emblemToShow;this.startDate=new Date(Date.parse(data.begin));this.endDate=new Date(Date.parse(data.end));this.cancelled=data.cancelled;this.visible=data.visible;this.published=data.published;this.agendaOnly=data.agendaEntryOnly;this.locationId=data.locationIds.length?data.locationIds[0]:null;this.dateModified=new Date(Date.parse(data.modifyDate));this._summary=data.shortDescription;this._html=data.descriptionAsHTML;this.location=null;this.group=null;this.topic=null}get title(){return EventfrogUtil.getLocalizedString(this._title)}get summary(){return EventfrogUtil.getLocalizedString(this._summary)}get html(){return EventfrogUtil.getLocalizedString(this._html)}}EventfrogEvent.apiEdge="/events.json";module.exports=EventfrogEvent},{"../util/EventfrogUtil":8}],3:[function(require,module,exports){const EventfrogUtil=require("../util/EventfrogUtil");class EventfrogGroup{constructor(data){this.id=data.id;this._title=data.title;this.link="https://eventfrog.ch"+data.url;this._html=data.descriptionAsHTML;this.image=data.imgs;this.dateModified=new Date(Date.parse(data.modifyDate))}get title(){return this._title}get html(){return EventfrogUtil.getLocalizedString(this._html)}}EventfrogGroup.apiEdge="/eventgroups.json";module.exports=EventfrogGroup},{"../util/EventfrogUtil":8}],4:[function(require,module,exports){const EventfrogUtil=require("../util/EventfrogUtil");class EventfrogLocation{constructor(data){this.id=data.id;this._title=data.title;this.link=data.url;this._html=data.descriptionAsHTML;this.image=data.img;this.address=data.addressLine;this.zip=data.zip;this.city=data.city;this.latitude=data.lat;this.longitude=data.lng;this.organizer={website:data.websiteUrl,facebook:data.facebookUrl,twitter:data.twitterUrl};this.dateModified=new Date(Date.parse(data.modifyDate))}get title(){return EventfrogUtil.getLocalizedString(this._title)}get html(){return EventfrogUtil.getLocalizedString(this._html)}}EventfrogLocation.apiEdge="/locations.json";module.exports=EventfrogLocation},{"../util/EventfrogUtil":8}],5:[function(require,module,exports){class EventfrogTopic{constructor(data){this.id=data.id;this.parentId=data.parentId;this._title=data.title;this.parent=null}get title(){return this._title}}EventfrogTopic.apiEdge="/rubrics.json";module.exports=EventfrogTopic},{}],6:[function(require,module,exports){const Eventfrog=require("./Eventfrog");const EventfrogService=require("./service/EventfrogService");(function($){const jQueryEventfrog=async function(opts){return Eventfrog(opts)};const jQueryEventfrogService=function(key){return new EventfrogService(key)};const jQueryEventfrogPromise=function(opts,success,error){jQueryEventfrog(opts).then(success).catch(error)};$.extend({eventfrog:jQueryEventfrog,eventfrogService:jQueryEventfrogService,efapi:jQueryEventfrogPromise})})(jQuery)},{"./Eventfrog":1,"./service/EventfrogService":7}],7:[function(require,module,exports){const EventfrogEvent=require("../entity/EventfrogEvent");const EventfrogGroup=require("../entity/EventfrogGroup");const EventfrogLocation=require("../entity/EventfrogLocation");const EventfrogTopic=require("../entity/EventfrogTopic");const EventfrogUtil=require("../util/EventfrogUtil");class EventfrogService{constructor(apiKey){this._key=apiKey}async loadEvents(options){let events=await this.getEvents(options);await this.mapLocations(events);await this.mapGroups(events);return events}async mapLocations(events){const locationIds=new Set(events.map(e=>e.locationId));const locations=await this.getLocations({id:[...locationIds]});const locationMap=new Map(locations.map(i=>[i.id,i]));events.forEach(event=>{event.location=locationMap.get(event.locationId)})}async mapGroups(events){const groupIds=new Set(events.map(e=>e.groupId));const groupData=await this.getGroups({groupId:[...groupIds]});const groupMap=new Map(groupData.map(i=>[i.id,i]));events.forEach(event=>{event.group=groupMap.get(event.groupId)})}async mapTopics(events){const topics=await this.loadTopics();const topicsMap=new Map(topics.map(i=>[i.id,i]));events.forEach(event=>{event.topic=topicsMap.get(event.topicId)})}async getEvents(options){const eventData=await this._get(EventfrogEvent.apiEdge,options);return eventData.events.map(i=>new EventfrogEvent(i))}async getLocations(options){const locationsData=await this._get(EventfrogLocation.apiEdge,options);return locationsData.locations.map(element=>new EventfrogLocation(element))}async getLocationsByIds(ids){return this.getLocations({id:ids})}async getGroups(options){const groupData=await this._get(EventfrogGroup.apiEdge,options);return groupData.eventgroups.map(i=>new EventfrogGroup(i))}async getGroupsByIds(ids){return this.getGroups({groupId:ids})}async loadTopics(){let topics=await this.getTopics();this.mapTopicParents(topics);return topics}async getTopics(){const topicData=await this._get(EventfrogTopic.apiEdge,{});return topicData.rubrics.map(i=>new EventfrogTopic(i))}mapTopicParents(topics){const topicMap=new Map(topics.map(i=>[i.id,i]));topics.forEach(topic=>{topic.parent=topicMap.get(topic.parentId)})}async _get(edge,options){const params=EventfrogUtil.getSearchParams(options);params.append("apiKey",this._key);const url=`${EventfrogService._base}${edge}?${params.toString()}`;const response=await fetch(url,{method:"GET"});if(!response.ok)return Promise.reject("Request returned "+response.status);const data=await response.json();return Promise.resolve(data)}}EventfrogService._base="//api.eventfrog.net/api/v1";module.exports=EventfrogService},{"../entity/EventfrogEvent":2,"../entity/EventfrogGroup":3,"../entity/EventfrogLocation":4,"../entity/EventfrogTopic":5,"../util/EventfrogUtil":8}],8:[function(require,module,exports){class EventfrogUtil{static getLocalizedString(versions,preferredLocale="de"){if(Object.keys(versions).length){if(preferredLocale in versions)return versions[preferredLocale];return versions[Object.keys(versions)[0]]}return null}static getSearchParams(options){const params=new URLSearchParams;for(const key in options){const value=options[key];if(Array.isArray(value)){for(const i in value){params.append(key,value[i])}}else if(value!==Object(value)){params.append(key,value)}}return params}}module.exports=EventfrogUtil},{}]},{},[6]);